{{- $pageurl := .Permalink }}
{{- $title := .Title }}

{{- $.Scratch.Set "tags" ""}}

{{- with .Params.Tags }}
{{- $hashtags := newScratch}}
{{- range . }}{{ $hashtags.Add "tags" (slice (replaceRE "(\\s)" "" . ))}}{{end}}
{{- $.Scratch.Set "tags" (delimit ($hashtags.Get "tags") ",") }}
{{- end -}}

{{- $custom := false }}
{{- $ShareButtons := (.Param "ShareButtons")}}
{{- with $ShareButtons }}{{ $custom = true }}{{ end }}

<ul class="share-buttons">
    {{- if (cond ($custom) (in $ShareButtons "facebook") (true)) }}
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share {{ $title | plainify }} on facebook"
            href="https://facebook.com/sharer/sharer.php?u={{ $pageurl }}">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
            </svg>
        </a>
    </li>
    {{- end }}
    {{- if (or (cond ($custom) (in $ShareButtons "x") (true)) (cond ($custom) (in $ShareButtons "twitter") (true))) }}
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share {{ $title | plainify }} on x"
            href="https://x.com/intent/tweet/?text={{ $title }}&amp;url={{ $pageurl }}&amp;hashtags={{- $.Scratch.Get "tags" -}}">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M512 62.554 L 512 449.446 C 512 483.97 483.97 512 449.446 512 L 62.554 512 C 28.03 512 0 483.97 0 449.446 L 0 62.554 C 0 28.03 28.029 0 62.554 0 L 449.446 0 C 483.971 0 512 28.03 512 62.554 Z M 269.951 190.75 L 182.567 75.216 L 56 75.216 L 207.216 272.95 L 63.9 436.783 L 125.266 436.783 L 235.9 310.383 L 332.567 436.783 L 456 436.783 L 298.367 228.367 L 432.367 75.216 L 371.033 75.216 Z M 127.633 110 L 164.101 110 L 383.481 400.065 L 349.5 400.065 Z" />
            </svg>
        </a>
    </li>
    {{- end }}
    {{- if (cond ($custom) (in $ShareButtons "threads") (true)) }}
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share {{ $title | plainify }} on threads"
            href="https://www.threads.net/intent/post?text={{ $title }}%20{{ $pageurl }}">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-98.09,132.806c-33.2,-19.18 -74.39,-28.28 -115.54,-25.53c-46.54,3.12 -85.88,20.86 -113.69,51.27c-27.45,30.01 -42.03,71.04 -42.03,118.46c0,47.42 14.58,88.45 42.03,118.46c27.81,30.41 67.15,48.15 113.69,51.27c41.15,2.75 82.34,-6.35 115.54,-25.53c2.62,-1.51 3.51,-4.87 2,-7.49l-15.83,-27.42c-1.51,-2.62 -4.87,-3.51 -7.49,-2c-26.1,15.08 -57.81,21.96 -89.08,19.87c-35.19,-2.36 -64.74,-15.24 -85.43,-37.22c-20.37,-21.63 -31.15,-52.09 -31.15,-88.04c0,-35.95 10.78,-66.41 31.15,-88.04c20.69,-21.98 50.24,-34.86 85.43,-37.22c31.27,-2.09 62.98,4.79 89.08,19.87c2.62,1.51 5.98,0.62 7.49,-2l15.83,-27.42c1.51,-2.62 0.62,-5.98 -2,-7.49l0,0Zm-36.65,141.43c-3.54,-36.42 -22.62,-57.08 -53.47,-68.27c-3.13,-1.13 -6.36,-2.14 -9.69,-3.04c5.61,-9.52 14.69,-16.68 27.4,-20.68c3.62,-1.14 5.64,-4.97 4.5,-8.59l-8.67,-27.58c-1.14,-3.62 -4.97,-5.64 -8.59,-4.5c-36.75,11.57 -59.05,41.87 -59.05,80.21c0,7.07 0.69,14.05 2.05,20.83c-20.79,5.38 -35.86,18.98 -42.7,39.31c-5.26,15.64 -4.93,33.52 0.93,50.34c8.66,24.86 28.09,44.08 51.97,51.39c11.47,3.51 23.65,4.91 35.72,4.03c22.78,-1.67 44.3,-11.31 59.6,-26.85c15.43,-15.67 24.1,-36.84 24.1,-59.55c0,-9.12 -1.19,-17.97 -3.54,-26.49l-20.56,-0.06Zm-72.38,64.14c-13.65,1 -26.53,-2.48 -35.91,-9.73c-8.46,-6.53 -14.3,-16.4 -16.45,-27.79c-2.19,-11.58 -0.7,-22.71 4.2,-31.36c4.78,-8.42 12.68,-14.25 23.54,-17.36c14.99,25.42 42.48,41.87 75.08,44.59c-4.57,14.41 -13.09,26.01 -24.6,33.62c-7.54,4.99 -16.49,7.53 -25.86,8.03Z"/>
            </svg>
        </a>
    </li>
    {{- end }}
    {{- if (cond ($custom) (in $ShareButtons "linkedin") (true)) }}
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share {{ $title | plainify }} on linkedin"
            href="https://www.linkedin.com/shareArticle?mini=true&amp;url={{ $pageurl }}&amp;title={{ $title }}&amp;summary={{ $title }}&amp;source={{ $pageurl }}">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
            </svg>
        </a>
    </li>
    {{- end }}
    {{- if (cond ($custom) (in $ShareButtons "share") (true)) }}
    <li>
        <a href="#" aria-label="share {{ $title | plainify }}" onclick="sharePost(event, '{{ $title | plainify }}', '{{ $pageurl }}')">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-128.446,144c-26.51,0 -48,21.49 -48,48c0,4.02 0.495,7.93 1.43,11.67l-89.79,44.89c-9.1,-9.01 -21.58,-14.56 -35.44,-14.56c-27.76,0 -50.2,22.44 -50.2,50.2c0,27.76 22.44,50.2 50.2,50.2c13.86,0 26.34,-5.55 35.44,-14.56l89.79,44.89c-0.935,3.74 -1.43,7.65 -1.43,11.67c0,26.51 21.49,48 48,48c26.51,0 48,-21.49 48,-48c0,-26.51 -21.49,-48 -48,-48c-13.97,0 -26.54,5.97 -35.32,15.49l-89.34,-44.67c1.17,-4.15 1.8,-8.54 1.8,-13.08c0,-4.54 -0.63,-8.93 -1.8,-13.08l89.34,-44.67c8.78,9.52 21.35,15.49 35.32,15.49c26.51,0 48,-21.49 48,-48c0,-26.51 -21.49,-48 -48,-48Z"/>
            </svg>
        </a>
    </li>
    {{- end }}
</ul>

{{- if (cond ($custom) (in $ShareButtons "share") (true)) }}
<script>
function sharePost(event, title, url) {
    event.preventDefault();
    if (navigator.share) {
        navigator.share({
            title: title,
            url: url
        }).catch(console.error);
    } else {
        // Fallback: copy to clipboard
        navigator.clipboard.writeText(url).then(function() {
            alert('URL copied to clipboard!');
        }).catch(function() {
            prompt('Copy this URL:', url);
        });
    }
}
</script>
{{- end }}
