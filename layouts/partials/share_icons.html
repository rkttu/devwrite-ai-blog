{{- $pageurl := .Permalink }}
{{- $title := .Title }}

{{- $.Scratch.Set "tags" ""}}

{{- with .Params.Tags }}
{{- $hashtags := newScratch}}
{{- range . }}{{ $hashtags.Add "tags" (slice (replaceRE "(\\s)" "" . ))}}{{end}}
{{- $.Scratch.Set "tags" (delimit ($hashtags.Get "tags") ",") }}
{{- end -}}

{{- $custom := false }}
{{- $ShareButtons := (.Param "ShareButtons")}}
{{- with $ShareButtons }}{{ $custom = true }}{{ end }}

<ul class="share-buttons">
    {{- if (cond ($custom) (in $ShareButtons "facebook") (true)) }}
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share {{ $title | plainify }} on facebook"
            href="https://facebook.com/sharer/sharer.php?u={{ $pageurl }}">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
            </svg>
        </a>
    </li>
    {{- end }}
    {{- if (or (cond ($custom) (in $ShareButtons "x") (true)) (cond ($custom) (in $ShareButtons "twitter") (true))) }}
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share {{ $title | plainify }} on x"
            href="https://x.com/intent/tweet/?text={{ $title }}&amp;url={{ $pageurl }}&amp;hashtags={{- $.Scratch.Get "tags" -}}">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M512 62.554 L 512 449.446 C 512 483.97 483.97 512 449.446 512 L 62.554 512 C 28.03 512 0 483.97 0 449.446 L 0 62.554 C 0 28.03 28.029 0 62.554 0 L 449.446 0 C 483.971 0 512 28.03 512 62.554 Z M 269.951 190.75 L 182.567 75.216 L 56 75.216 L 207.216 272.95 L 63.9 436.783 L 125.266 436.783 L 235.9 310.383 L 332.567 436.783 L 456 436.783 L 298.367 228.367 L 432.367 75.216 L 371.033 75.216 Z M 127.633 110 L 164.101 110 L 383.481 400.065 L 349.5 400.065 Z" />
            </svg>
        </a>
    </li>
    {{- end }}
    {{- if (cond ($custom) (in $ShareButtons "threads") (true)) }}
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share {{ $title | plainify }} on threads"
            href="https://www.threads.net/intent/post?text={{ $title }}%20{{ $pageurl }}">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path fill-rule="evenodd"
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0ZM331.9422 244.3435C330.5636 243.6827 329.1633 243.0467 327.7447 242.4378C325.2742 196.9172 300.4009 170.8566 258.6357 170.5899C258.4465 170.5887 258.2583 170.5887 258.0691 170.5887C233.0881 170.5887 212.3118 181.2519 199.524 200.6554L222.4936 216.4121C232.0465 201.9183 247.0389 198.8286 258.0801 198.8286C258.2076 198.8286 258.3356 198.8286 258.4618 198.8297C272.2136 198.9174 282.5906 202.9157 289.307 210.7129C294.1946 216.3896 297.4636 224.234 299.0823 234.134C286.8898 232.0617 273.7039 231.4246 259.6077 232.2327C219.8993 234.52 194.3715 257.6788 196.086 289.8588C196.956 306.182 205.088 320.2248 218.9829 329.3983C230.7309 337.1532 245.8616 340.9456 261.5869 340.0871C282.3539 338.9486 298.6455 331.0253 310.0111 316.5374C318.6429 305.5352 324.1023 291.2774 326.5128 273.3121C336.4097 279.285 343.7445 287.1449 347.7953 296.5934C354.6834 312.655 355.0851 339.0486 333.5492 360.5662C314.6804 379.4167 291.9992 387.5716 257.7215 387.8234C219.6984 387.5416 190.942 375.3475 172.2454 351.5794C154.7376 329.3233 145.6894 297.1769 145.3519 256.032C145.6894 214.8868 154.7376 182.74 172.2454 160.4841C190.942 136.7163 219.6979 124.5224 257.721 124.2398C296.02 124.5245 325.2775 136.7772 344.6897 160.6596C354.2083 172.3713 361.3847 187.0995 366.1157 204.2722L393.0327 197.0905C387.2982 175.953 378.2748 157.7385 365.9957 142.6327C341.109 112.0143 304.7117 96.3253 257.8149 96.0H257.6272C210.8256 96.3242 174.8359 112.0729 150.6581 142.8082C129.1431 170.1588 118.0451 208.2153 117.6722 255.9195L117.671 256.032L117.6722 256.1445C118.0451 303.8482 129.1431 341.9058 150.6581 369.2563C174.8359 399.9908 210.8256 415.7406 257.6272 416.064H257.8149C299.424 415.7756 328.7532 404.8818 352.9147 380.7419C384.526 349.1606 383.5742 309.5744 373.1554 285.2728C365.6806 267.846 351.4294 253.6919 331.9422 244.3435ZM260.1003 311.8882C242.6968 312.8684 224.6164 305.0568 223.7249 288.3251C223.0641 275.9193 232.5536 262.0765 261.1684 260.4275C264.4453 260.2385 267.661 260.1462 270.82 260.1462C281.2137 260.1462 290.9373 261.1559 299.7774 263.0884C296.4801 304.2666 277.1396 310.953 260.1003 311.8882Z"/>
            </svg>
        </a>
    </li>
    {{- end }}
    {{- if (cond ($custom) (in $ShareButtons "linkedin") (true)) }}
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share {{ $title | plainify }} on linkedin"
            href="https://www.linkedin.com/shareArticle?mini=true&amp;url={{ $pageurl }}&amp;title={{ $title }}&amp;summary={{ $title }}&amp;source={{ $pageurl }}">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
            </svg>
        </a>
    </li>
    {{- end }}
    {{- if (cond ($custom) (in $ShareButtons "share") (true)) }}
    <li>
        <a href="#" aria-label="share {{ $title | plainify }}" onclick="sharePost(event, '{{ $title | plainify }}', '{{ $pageurl }}')">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-128.446,144c-26.51,0 -48,21.49 -48,48c0,4.02 0.495,7.93 1.43,11.67l-89.79,44.89c-9.1,-9.01 -21.58,-14.56 -35.44,-14.56c-27.76,0 -50.2,22.44 -50.2,50.2c0,27.76 22.44,50.2 50.2,50.2c13.86,0 26.34,-5.55 35.44,-14.56l89.79,44.89c-0.935,3.74 -1.43,7.65 -1.43,11.67c0,26.51 21.49,48 48,48c26.51,0 48,-21.49 48,-48c0,-26.51 -21.49,-48 -48,-48c-13.97,0 -26.54,5.97 -35.32,15.49l-89.34,-44.67c1.17,-4.15 1.8,-8.54 1.8,-13.08c0,-4.54 -0.63,-8.93 -1.8,-13.08l89.34,-44.67c8.78,9.52 21.35,15.49 35.32,15.49c26.51,0 48,-21.49 48,-48c0,-26.51 -21.49,-48 -48,-48Z"/>
            </svg>
        </a>
    </li>
    {{- end }}
</ul>

{{- if (cond ($custom) (in $ShareButtons "share") (true)) }}
<script>
function sharePost(event, title, url) {
    event.preventDefault();
    if (navigator.share) {
        navigator.share({
            title: title,
            url: url
        }).catch(console.error);
    } else {
        // Fallback: copy to clipboard
        navigator.clipboard.writeText(url).then(function() {
            alert('URL copied to clipboard!');
        }).catch(function() {
            prompt('Copy this URL:', url);
        });
    }
}
</script>
{{- end }}
